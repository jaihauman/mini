<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TikTok Simple Feed</title>

<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body { background: #000; overflow: hidden; }

#feed {
    height: 100vh;
    width: 100vw;
    overflow-y: scroll;
    scroll-snap-type: y mandatory;
    -webkit-overflow-scrolling: touch;
}
#feed::-webkit-scrollbar { display: none; }

.post {
    height: 100vh;
    width: 100vw;
    position: relative;
    scroll-snap-align: start;
    background: black;
    display: flex;
    align-items: center;
    justify-content: center;
}

video {
    width: 100%;
    height: 100%;
    object-fit: contain;
}

/* PROGRESS BAR */
#progressContainer {
    position: fixed;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 7px;
    background: rgba(255,255,255,0.2);
    z-index: 9999;
}
#progressBar {
    height: 100%;
    width: 0%;
    background: red;
}

/* PLAY/PAUSE ICON */
#playPauseIcon {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 70px;
    color: white;
    opacity: 0;
    transition: opacity 0.25s ease;
    pointer-events: none;
    z-index: 99999;
    font-weight: bold;
    line-height: 0;
}
</style>
</head>
<body>

<div id="feed"></div>

<!-- Play/Pause Icon -->
<div id="playPauseIcon">❚❚</div>

<!-- Progress Bar -->
<div id="progressContainer">
    <div id="progressBar"></div>
</div>

<script>
/* SAMPLE VIDEOS */
const videoList = [
    "https://samplelib.com/lib/preview/mp4/sample-5s.mp4",
    "https://samplelib.com/lib/preview/mp4/sample-10s.mp4",
    "https://samplelib.com/lib/preview/mp4/sample-15s.mp4",
    "https://samplelib.com/lib/preview/mp4/sample-20s.mp4",
    "https://samplelib.com/lib/preview/mp4/sample-30s.mp4"
];

function getRandomVideo() {
    return videoList[Math.floor(Math.random() * videoList.length)];
}

const feed = document.getElementById("feed");
const progressContainer = document.getElementById("progressContainer");
const progressBar = document.getElementById("progressBar");
let currentVideo = null;

/* ICON HANDLER */
function showPlayPauseIcon(isPlaying) {
    const icon = document.getElementById("playPauseIcon");

    if (isPlaying) {
        icon.textContent = "❚❚";  // clean pause icon
    } else {
        icon.textContent = "▲";   // clean white triangle (play)
    }

    icon.style.opacity = 1;

    setTimeout(() => {
        icon.style.opacity = 0;
    }, 800);
}

/* CREATE POST */
function createPost() {
    const div = document.createElement("div");
    div.className = "post";

    const video = document.createElement("video");
    video.src = getRandomVideo();
    video.muted = true;
    video.playsInline = true;
    video.preload = "auto";

    /* Tap Play/Pause */
    video.addEventListener("click", () => {
        if (video.paused) {
            video.play();
            showPlayPauseIcon(true);
        } else {
            video.pause();
            showPlayPauseIcon(false);
        }
    });

    /* Autoplay when loaded */
    video.addEventListener("loadeddata", () => video.play());

    /* Auto next */
    video.addEventListener("ended", () => {
        feed.scrollBy({ top: window.innerHeight, behavior: "smooth" });
    });

    div.appendChild(video);
    return div;
}

/* Initial videos */
for (let i = 0; i < 4; i++) {
    feed.appendChild(createPost());
}

/* Detect current video */
function updateCurrentVideo() {
    const posts = document.querySelectorAll(".post");
    let mid = window.innerHeight / 2;

    posts.forEach(post => {
        const rect = post.getBoundingClientRect();
        const vid = post.querySelector("video");

        if (rect.top < mid && rect.bottom > mid) {
            if (currentVideo !== vid) {
                if (currentVideo) currentVideo.pause();
                currentVideo = vid;
                currentVideo.play();
                progressBar.style.width = "0%";
            }
        }
    });

    /* Infinite load */
    if (posts[posts.length - 2].getBoundingClientRect().top < window.innerHeight) {
        feed.appendChild(createPost());
    }
}

/* Update progress bar */
function updateProgress() {
    if (!currentVideo || !currentVideo.duration) return;
    let percent = (currentVideo.currentTime / currentVideo.duration) * 100;
    progressBar.style.width = percent + "%";
}
setInterval(updateProgress, 50);

/* SEEKING BAR */
let seeking = false;

function seek(e) {
    if (!currentVideo || !currentVideo.duration) return;

    const rect = progressContainer.getBoundingClientRect();
    const x = e.clientX - rect.left;
    const percent = Math.max(0, Math.min(1, x / rect.width));

    currentVideo.currentTime = percent * currentVideo.duration;
    progressBar.style.width = (percent * 100) + "%";
}

progressContainer.addEventListener("mousedown", e => { seeking = true; seek(e); });
progressContainer.addEventListener("mousemove", e => { if (seeking) seek(e); });
document.addEventListener("mouseup", () => seeking = false);

progressContainer.addEventListener("touchstart", e => { seeking = true; seek(e.touches[0]); });
progressContainer.addEventListener("touchmove", e => { if (seeking) seek(e.touches[0]); });
document.addEventListener("touchend", () => seeking = false);

/* On scroll: update video */
feed.addEventListener("scroll", updateCurrentVideo);

updateCurrentVideo();
</script>

</body>
</html>
